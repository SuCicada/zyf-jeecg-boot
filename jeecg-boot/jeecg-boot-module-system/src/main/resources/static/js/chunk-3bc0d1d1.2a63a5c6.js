(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3bc0d1d1"],{2914:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("div",{staticClass:"user-login-other"}),e("a-modal",{attrs:{title:"请输入密码",visible:t.thirdPasswordShow},on:{ok:t.thirdLoginCheckPassword,cancel:t.thirdLoginNoPassword}},[e("a-input-password",{attrs:{placeholder:"请输入密码"},model:{value:t.thirdLoginPassword,callback:function(i){t.thirdLoginPassword=i},expression:"thirdLoginPassword"}})],1),e("a-modal",{class:"ant-modal-confirm",attrs:{footer:null,closable:!1,visible:t.thirdConfirmShow}},[e("div",{staticClass:"ant-modal-confirm-body-wrapper"},[e("div",{staticClass:"ant-modal-confirm-body"},[e("a-icon",{staticStyle:{color:"#faad14"},attrs:{type:"question-circle"}}),e("span",{staticClass:"ant-modal-confirm-title"},[t._v("提示")]),e("div",{staticClass:"ant-modal-confirm-content"},[t._v("\n            已有同名账号存在,请确认是否绑定该账号？\n          ")])],1),e("div",{staticClass:"ant-modal-confirm-btns"},[e("a-button",{attrs:{loading:t.thirdCreateUserLoding},on:{click:t.thirdLoginUserCreate}},[t._v("创建新账号")]),e("a-button",{attrs:{type:"primary"},on:{click:t.thirdLoginUserBind}},[t._v("确认绑定")])],1)])]),e("a-modal",{class:"ant-modal-confirm",attrs:{visible:t.bindingPhoneModal}},[e("template",{slot:"footer"},[e("a-button",{key:"submit",attrs:{type:"primary"},on:{click:t.thirdHandleOk}},[t._v("\n          确定\n        ")])],1),e("div",{staticClass:"ant-modal-confirm-body-wrapper"},[e("a-form-item",[e("span",[t._v("绑定手机号")])]),e("a-form-item",[e("a-input",{attrs:{size:"large",type:"text",placeholder:"手机号"},model:{value:t.thirdPhone,callback:function(i){t.thirdPhone=i},expression:"thirdPhone"}},[e("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mobile"},slot:"prefix"})],1)],1),e("a-row",{attrs:{gutter:16}},[e("a-col",{staticClass:"gutter-row",attrs:{span:16}},[e("a-form-item",[e("a-input",{attrs:{size:"large",type:"text",placeholder:"请输入验证码"},model:{value:t.thirdCaptcha,callback:function(i){t.thirdCaptcha=i},expression:"thirdCaptcha"}},[e("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1)],1),e("a-col",{staticClass:"gutter-row",attrs:{span:8}},[e("a-button",{staticClass:"getCaptcha",attrs:{tabindex:"-1",disabled:t.thirdState.smsSendBtn},domProps:{textContent:t._s(t.thirdState.smsSendBtn?t.thirdState.time+" s":"获取验证码")},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.getThirdCaptcha(i)}}})],1)],1)],1)],2)],1)},o=[],r=e("2f62"),s=e("0fea"),a=e("ca00");function d(t){return d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function c(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,n)}return e}function h(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?c(Object(e),!0).forEach((function(i){l(t,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):c(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}return t}function l(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var u={data:function(){return{thirdLoginInfo:"",thirdPasswordShow:!1,thirdLoginPassword:"",thirdLoginUser:"",thirdConfirmShow:!1,thirdCreateUserLoding:!1,thirdLoginState:!1,bindingPhoneModal:!1,thirdPhone:"",thirdCaptcha:"",thirdState:{time:30,smsSendBtn:!1},thirdUserUuid:"",thirdType:"",url:{bindingThirdPhone:"/sys/thirdLogin/bindingThirdPhone"}}},created:function(){},methods:h(h({},Object(r["b"])(["ThirdLogin"])),{},{onThirdLogin:function(t){var i=window._CONFIG["domianURL"]+"/sys/thirdLogin/render/".concat(t);window.open(i,"login ".concat(t),"height=500, width=500, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=n o, status=no");var e=this;e.thirdType=t,e.thirdLoginInfo="",e.thirdLoginState=!1;var n=function(t){var i=t.data;if("string"===typeof i)if("登录失败"===i)e.$message.warning(i);else if(i.includes("绑定手机号")){e.bindingPhoneModal=!0;var n=i.split(",");e.thirdUserUuid=n[1]}else e.doThirdLogin(i);else"object"===d(i)?!0===i["isObj"]&&(e.thirdConfirmShow=!0,e.thirdLoginInfo=h({},i)):e.$message.warning("不识别的信息传递")};window.addEventListener("message",n,!1)},doThirdLogin:function(t){var i=this;if(!1===this.thirdLoginState){this.thirdLoginState=!0;var e={};e.thirdType=this.thirdType,e.token=t,this.ThirdLogin(e).then((function(t){t.success?i.loginSuccess():i.requestFailed(t)}))}},thirdLoginUserBind:function(){this.thirdLoginPassword="",this.thirdLoginUser=this.thirdLoginInfo.uuid,this.thirdConfirmShow=!1,this.thirdPasswordShow=!0},thirdLoginUserCreate:function(){var t=this;this.thirdCreateUserLoding=!0,this.thirdLoginInfo["suffix"]=parseInt(98*Math.random()+1),Object(s["i"])("/sys/third/user/create",this.thirdLoginInfo).then((function(i){if(i.success){var e=i.result;t.doThirdLogin(e),t.thirdConfirmShow=!1}else t.$message.warning(i.message)})).finally((function(){t.thirdCreateUserLoding=!1}))},thirdLoginCheckPassword:function(){var t=this,i=Object.assign({},this.thirdLoginInfo,{password:this.thirdLoginPassword});Object(s["i"])("/sys/third/user/checkPassword",i).then((function(i){i.success?(t.thirdLoginNoPassword(),t.doThirdLogin(i.result)):t.$message.warning(i.message)}))},thirdLoginNoPassword:function(){this.thirdPasswordShow=!1,this.thirdLoginPassword="",this.thirdLoginUser=""},getThirdCaptcha:function(){var t=this,i=this;if(this.thirdPhone){this.thirdState.smsSendBtn=!0;var e=window.setInterval((function(){i.thirdState.time--<=0&&(i.thirdState.time=30,i.thirdState.smsSendBtn=!1,window.clearInterval(e))}),1e3),n=this.$message.loading("验证码发送中..",0),o={};o.mobile=this.thirdPhone,o.smsmode="1",Object(s["i"])("/sys/sms",o).then((function(i){i.success||(setTimeout(n,0),t.cmsFailed(i.message)),setTimeout(n,500)})).catch((function(o){setTimeout(n,1),clearInterval(e),i.thirdState.time=30,i.thirdState.smsSendBtn=!1,t.requestFailed(o)}))}else i.cmsFailed("请输入手机号")},thirdHandleOk:function(){var t=this,i={};i.mobile=this.thirdPhone,i.captcha=this.thirdCaptcha,i.thirdUserUuid=this.thirdUserUuid,Object(s["i"])(this.url.bindingThirdPhone,i).then((function(i){i.success?(t.bindingPhoneModal=!1,t.doThirdLogin(i.result)):t.$message.$warning(i.message)}))},loginSuccess:function(){this.$router.push({path:"/dashboard/analysis"}).catch((function(){})),this.$notification.success({message:"欢迎",description:"".concat(Object(a["n"])(),"，欢迎回来")})},cmsFailed:function(t){this.$notification["error"]({message:"登录失败",description:t,duration:4})},requestFailed:function(t){this.$notification["error"]({message:"登录失败",description:((t.response||{}).data||{}).message||t.message||"请求出现错误，请稍后再试",duration:4}),this.loginBtn=!1}})},f=e("0c63"),g=f["a"].createFromIconfontCN({scriptUrl:"/cdn/font-icon/font_2316098_umqusozousr.js"}),m={name:"thirdLogin",mixins:[u],components:{IconFont:g}},p=m,b=(e("e15e"),e("2877")),w=Object(b["a"])(p,n,o,!1,null,"df3cf056",null);i["default"]=w.exports},dc6e:function(t,i,e){},e15e:function(t,i,e){"use strict";e("dc6e")}}]);